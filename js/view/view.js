// Generated by CoffeeScript 1.10.0
(function() {
  var View, checkShowHide, checkShowHideGameMode;

  checkShowHide = function(element, condition) {
    if (condition) {
      return element.show(100);
    } else {
      return element.hide(100);
    }
  };

  checkShowHideGameMode = function(element, gameModeList) {
    return checkShowHide(element, isMode(gameModeList));
  };

  View = (function() {
    function View() {
      this.table = $("#mainTable");
      this.tbody = this.table.find("tbody");
      this.addPlayerButton = $('#addPlayerButton');
      this.modeButtonText = $("#modeText");
      mgModelSettings.daySecondCallback = (function(_this) {
        return function() {
          return _this.updateTime();
        };
      })(this);
    }

    View.prototype.generatePlayer = function(player) {
      return $("<tr>").addClass("player").attr("id", "player" + player.id).append([$("<td>").addClass("plId"), $("<td>").addClass("plName"), $("<td>").addClass("plHealth"), $("<td>").addClass("plDamage"), $("<td>").addClass("plTreat"), $("<td>").addClass("plSolvedUnsolved"), $("<td colspan='3'>").addClass("plActions").append([btn("solve" + player.id, "Решена", "green darken-1"), btn("unsolve" + player.id, "Не решена", "red darken-1"), $("<select id='treat" + player.id + "'>").addClass("waves-effect waves-light btn blue darken-1").append([$("<option value='0'>"), $("<option value='1'>"), $("<option value='2'>"), $("<option value='3'>")]), btn("penalty" + player.id, "Штраф", "orange darken-1")])]);
    };

    View.prototype.updatePlayer = function(player) {
      var i, len, opt, playerEl, ref;
      playerEl = $("#player" + player.id);
      if (!playerEl.length) {
        playerEl = this.generatePlayer(player);
        this.tbody.append(playerEl);
        playerEl.hide();
      }
      playerEl.removeClass().addClass(player.getLevel());
      playerEl.find(".plId").text(player.id);
      playerEl.find(".plName").text(player.name);
      playerEl.find(".plHealth").text(player.health);
      playerEl.find(".plDamage").text(player.getAttackValue());
      playerEl.find(".plTreat").text(player.getTreatValue(3));
      ref = playerEl.find("option");
      for (i = 0, len = ref.length; i < len; i++) {
        opt = ref[i];
        opt = $(opt);
        opt.text((opt.val()) + " верно (" + (player.getTreatValue(opt.val())) + ")");
      }
      playerEl.find(".plSolvedUnsolved").text(player.solved + "/" + player.unsolved);
      playerEl.show(1000);
    };

    View.prototype.updatePlayers = function() {
      var i, len, player, ref;
      ref = mgModel.players;
      for (i = 0, len = ref.length; i < len; i++) {
        player = ref[i];
        this.updatePlayer(player);
      }
    };

    View.prototype.updateTime = function() {
      var min, sec, time;
      time = mgModelSettings.time;
      min = Math.floor(time / 60);
      min = min < 10 ? "0" + min : min;
      sec = time % 60;
      sec = sec < 10 ? "0" + sec : sec;
      return this.modeButtonText.text("День (" + min + ":" + sec + ")");
    };

    View.prototype.updatePanel = function() {
      if (isMode(MODE_ADD)) {
        this.modeButtonText.text("Добавление игроков");
      } else if (isMode(MODE_DAY)) {
        this.updateTime();
      } else if (isMode(MODE_NIGHT)) {
        this.modeButtonText.text("Ночь");
      }
      return checkShowHideGameMode(this.addPlayerButton, MODE_ADD);
    };

    View.prototype.update = function() {
      this.updatePlayers();
      return this.updatePanel();
    };

    return View;

  })();

  window.mgView = new View();

  mgView.update();

}).call(this);

//# sourceMappingURL=view.js.map
